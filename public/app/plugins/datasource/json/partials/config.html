<h5>JSON Endpoints</h5>

<p ng-repeat="(k, v) in $scope">{{k}} -> {{v}}</p>

<div ng-init="current.jsonData.endpoints = current.jsonData.endpoints || []">
	
  <div ng-repeat="endpoint in current.jsonData.endpoints">
    
    <div class="tight-form">
  	  
      <ul class="tight-form-list">
        <li class="tight-form-item" style="width: 80px">
          Name
        </li>
        <li class="tight-form-item">
          <input type="text" class="tight-form-input input-xlarge" ng-model="endpoint.name" placeholder=""></input>
        </li>
      </ul>
      <div class="clearfix"></div>

      <ul class="tight-form-list">
  		  <li class="tight-form-item" style="width: 80px">
  				URL
  			</li>
  			<li class="tight-form-item">
  				<input type="text"
                 class="tight-form-input input-xlarge"
                 ng-model="endpoint.url"
                 placeholder="http://my.server.com:8080" ng-pattern="/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/"></input>
  			</li>
        <li class="tight-form-item">
          Access <tip>Direct = url is used directly from browser, Proxy = Grafana backend will proxy the request</tip>
        </li>
        <li>
          <select class="input-medium tight-form-input" ng-model="endpoint.access" ng-options="f for f in ['direct', 'proxy']"></select>
        </li>
  		</ul>

  		<div class="clearfix"></div>

  		<ul class="tight-form-list">
  			<li class="tight-form-item" style="width: 80px">
  				Method
  			</li>
  			<li class="tight-form-item">
  				<select class="tight-form-input input-medium" ng-model="endpoint.method">
  					<option value="GET">GET</option>
  					<option value="POST">POST</option>
  				</select>
  			</li>
  		</ul>
  		<div class="clearfix"></div>

      <ul class="tight-form-list">
        <li class="tight-form-item" style="width: 80px">
          Time Format:
        </li>
        <li class="tight-form-item">
          <select class="tight-form-input input-large" ng-model="endpoint.timeFormat">
            <option value="epoch_ms">Millseconds since UTC Epoch</option>
            <option value="epoch_seconds">Seconds since UTC Epoch</option>
            <option value="iso8601">ISO 8601</option>
          </select>
        </li>
      </ul>
      <div class="clearfix"></div>

      <ul class="tight-form-list">
        <li class="tight-form-item" style="width: 80px">
          Basic Auth
        </li>
        <li class="tight-form-item">
          <editor-checkbox text="Enable" model="endpoint.basicAuth"></editor-checkbox>
        </li>
        <li class="tight-form-item" ng-if="endpoint.basicAuth">
          User
        </li>
        <li ng-if="endpoint.basicAuth">
          <input type="text" class="tight-form-input input-medium" style="width: 139px" ng-model='endpoint.basicAuthUser' placeholder="user" required></input>
        </li>
        <li class="tight-form-item" style="width: 67px" ng-if="endpoint.basicAuth">
          Password
        </li>
        <li ng-if="endpoint.basicAuth">
          <input type="password" class="tight-form-input input-medium" ng-model='endpoint.basicAuthPassword' placeholder="password" required></input>
        </li>
      </ul>
      <div class="clearfix"></div>

      <ul class="tight-form-list">
        <li class="tight-form-item last">
          <a class="pointer" ng-click="current.jsonData.endpoints.splice($index, 1)">
            <i class="fa fa-remove"></i>
          </a>
        </li>
      </ul>
      <div class="clearfix"></div>
    </div>
    
    <br/>

  </div>

  <button class="btn" ng-click="current.jsonData.endpoints.push({name: '', url: '', method: 'GET', timeFormat: 'epoch_seconds'});">Add Endpoint</button>

</div>
